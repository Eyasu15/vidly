{"ast":null,"code":"var _jsxFileName = \"/Users/esuweld/Desktop/Main Studies/vidly-app/src/components/rentalComponent/rentalForm.jsx\";\nimport React, { Component } from \"react\";\nimport Form from \"../common/form\";\nimport Joi from \"joi-browser\";\nimport { getOneRental, addRental, getMoviesDTO, getCustomersDTO } from \"../services/rentalsService\";\nimport { toast } from \"react-toastify\";\n\nclass RentalForm extends Form {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      id: \"\",\n      data: {\n        movie: \"\",\n        customer: \"\",\n        dateOut: \"\",\n        dateReturned: \"\",\n        status: \"\",\n        rentalFee: \"\"\n      },\n      movies: [],\n      customers: [],\n      errors: {}\n    };\n    this.schema = {\n      id: Joi.number(),\n      movie: Joi.required(),\n      customer: Joi.number().required(),\n      dateOut: Joi.date().required(),\n      dateReturned: Joi.date(),\n      status: Joi.string().required(),\n      rentalFee: Joi.number()\n    };\n\n    this.populateRentalForm = async () => {\n      const rentalId = this.props.match.params.id;\n      if (rentalId === \"new\") return;\n\n      try {\n        const {\n          data\n        } = await getOneRental(rentalId);\n        this.setState({\n          data\n        });\n        console.log(data);\n      } catch (ex) {\n        toast.error(ex.response.message);\n      }\n    };\n\n    this.doSubmit = async () => {\n      const data = this.state.data;\n\n      try {\n        await addRental(data);\n      } catch (ex) {\n        if (ex.response.status === 400) {\n          const {\n            errors\n          } = this.state;\n          errors.name = ex.response.message;\n        }\n      }\n\n      this.props.history.replace(\"/rentals\");\n    };\n  }\n\n  async componentDidMount() {\n    const {\n      data: movies\n    } = await getMoviesDTO();\n    const {\n      data: customers\n    } = await getCustomersDTO();\n    this.setState({\n      movies,\n      customers\n    });\n    console.log(movies);\n    await this.populateRentalForm();\n  }\n\n  render() {\n    const {\n      movies,\n      customers\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }\n    }, \"Rental Form\"), /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.handleSubmit,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 9\n      }\n    }, this.renderSelect(\"movie\", \"Movie\", movies), this.renderSelect(\"customer\", \"Customer\", customers), this.renderInput(\"dateOut\", \"Date Out\", \"date\"), this.renderInput(\"dateReturned\", \"Return Date\", \"date\"), this.renderInput(\"status\", \"Status\"), this.renderInput(\"rentalFee\", \"Fee\")));\n  }\n\n}\n\nexport default RentalForm;","map":{"version":3,"sources":["/Users/esuweld/Desktop/Main Studies/vidly-app/src/components/rentalComponent/rentalForm.jsx"],"names":["React","Component","Form","Joi","getOneRental","addRental","getMoviesDTO","getCustomersDTO","toast","RentalForm","state","id","data","movie","customer","dateOut","dateReturned","status","rentalFee","movies","customers","errors","schema","number","required","date","string","populateRentalForm","rentalId","props","match","params","setState","console","log","ex","error","response","message","doSubmit","name","history","replace","componentDidMount","render","handleSubmit","renderSelect","renderInput"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Form from \"../common/form\";\nimport Joi from \"joi-browser\";\nimport {\n  getOneRental,\n  addRental,\n  getMoviesDTO,\n  getCustomersDTO,\n} from \"../services/rentalsService\";\nimport { toast } from \"react-toastify\";\n\nclass RentalForm extends Form {\n  state = {\n    id: \"\",\n    data: {\n      movie: \"\",\n      customer: \"\",\n      dateOut: \"\",\n      dateReturned: \"\",\n      status: \"\",\n      rentalFee: \"\",\n    },\n    movies: [],\n    customers: [],\n    errors: {},\n  };\n\n  schema = {\n    id: Joi.number(),\n    movie: Joi.required(),\n    customer: Joi.number().required(),\n    dateOut: Joi.date().required(),\n    dateReturned: Joi.date(),\n    status: Joi.string().required(),\n    rentalFee: Joi.number(),\n  };\n\n  async componentDidMount() {\n    const { data: movies } = await getMoviesDTO();\n    const { data: customers } = await getCustomersDTO();\n    this.setState({ movies, customers });\n    console.log(movies);\n    await this.populateRentalForm();\n  }\n\n  populateRentalForm = async () => {\n    const rentalId = this.props.match.params.id;\n    if (rentalId === \"new\") return;\n    try {\n      const { data } = await getOneRental(rentalId);\n      this.setState({ data });\n      console.log(data);\n    } catch (ex) {\n      toast.error(ex.response.message);\n    }\n  };\n\n  doSubmit = async () => {\n    const data = this.state.data;\n    try {\n      await addRental(data);\n    } catch (ex) {\n      if (ex.response.status === 400) {\n        const { errors } = this.state;\n        errors.name = ex.response.message;\n      }\n    }\n    this.props.history.replace(\"/rentals\");\n  };\n\n  render() {\n    const { movies, customers } = this.state;\n    return (\n      <div>\n        <h1>Rental Form</h1>\n        <form onSubmit={this.handleSubmit}>\n          {this.renderSelect(\"movie\", \"Movie\", movies)}\n          {this.renderSelect(\"customer\", \"Customer\", customers)}\n          {this.renderInput(\"dateOut\", \"Date Out\", \"date\")}\n          {this.renderInput(\"dateReturned\", \"Return Date\", \"date\")}\n          {this.renderInput(\"status\", \"Status\")}\n          {this.renderInput(\"rentalFee\", \"Fee\")}\n        </form>\n      </div>\n    );\n  }\n}\n\nexport default RentalForm;\n"]},"metadata":{},"sourceType":"module"}